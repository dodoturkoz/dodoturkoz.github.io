<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>A Quick Sage Tutorial on Graphs and Groups: Part 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">A Quick Sage Tutorial on Graphs and Groups: Part 1</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Doğukan E. Türköz</p>
<section id="intro" class="level3">
<h3 class="anchored" data-anchor-id="intro">0. Intro</h3>
<p>This part of the tutorial assumes very little mathematics knowledge and some basic understanding of Python. There are several different ways to run Sage. One could either download one of its packages or use the Sage Cell Server to run Sage code online. A warning to the online users: Note that some the examples depend on constants which were defined in previous cells, so you will need to define relevant constants as you go along. Similarly, if you are following along the Jupyter Notebook you will need to run all the cells for certain cells to work.</p>
<p>Sage has a very detailed <a href="https://doc.sagemath.org/html/en/reference/graphs/index.html">documentation</a> on graph theory, which might seem daunting at a first look, but it has lots of examples. If you are unsure about a certain function you have two options. Either search through the documentation or do some inspired guesswork. If you press tab after writing a few letters, a dropdown list will appear with some suggestions. Another nice trick is that if you put a question mark after a function, the relevant section of the documentation will be opened.</p>
<div class="cell" data-execution_count="58">
<pre class="sage cell-code"><code>graphs.CompleteGraph?</code></pre>
</div>
</section>
<section id="graphs" class="level3">
<h3 class="anchored" data-anchor-id="graphs">1. Graphs</h3>
<p>In this section, I will prioritize examples over formality. Let’s borrow Wikipedia’s definition of graph theory and a graph.</p>
<p>“In mathematics, graph theory is the study of graphs, which are mathematical structures used to model pairwise relations between objects. A graph in this context is made up of vertices (also called nodes or points) which are connected by edges (also called links or lines).”</p>
<p>Our first example will be the complete graph on <span class="math inline">\(n\)</span> vertices, denoted <span class="math inline">\(K_n\)</span>. Let’s plot this graph for <span class="math inline">\(n=5\)</span>.</p>
<div class="cell" data-execution_count="61">
<pre class="sage cell-code"><code>K5 = graphs.CompleteGraph(5)</code></pre>
</div>
<div class="cell" data-execution_count="62">
<pre class="sage cell-code"><code>K5</code></pre>
<div class="cell-output cell-output-display" data-execution_count="62">
<p><img src="index_files/figure-html/cell-4-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><strong>Exercise</strong>: Change CompleteGraph to other types of well-known graph families. (For example, try PathGraph and CycleGraph).</p>
<p>Try to guess what the what the following functions are doing.</p>
<div class="cell" data-execution_count="59">
<pre class="sage cell-code"><code>K5.order()</code></pre>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>5</code></pre>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="60">
<pre class="sage cell-code"><code>K5.size()</code></pre>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>10</code></pre>
</div>
</div>
<p><strong>Exercise</strong> : Find an expression for the number of edges of <span class="math inline">\(K_n\)</span> for arbitrary <span class="math inline">\(n\)</span>.</p>
<p>The <strong>degree</strong> of a vertex is the number of vertices adjacent to it. This is the same the number of edges incident to this vertex. Let’s see an example by computing the degree of vertex 1 in the following graph.</p>
<div class="cell" data-execution_count="77">
<pre class="sage cell-code"><code>B = graphs.BullGraph()</code></pre>
</div>
<div class="cell" data-execution_count="79">
<pre class="sage cell-code"><code>B</code></pre>
<div class="cell-output cell-output-display" data-execution_count="79">
<p><img src="index_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="80">
<pre class="sage cell-code"><code>B.degree(1)</code></pre>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre><code>3</code></pre>
</div>
</div>
<p>Now, let’s list the degree of a graph from the greatest to the lowest. Such a sequence is called the <strong>degree sequence</strong> of a graph.</p>
<div class="cell" data-execution_count="78">
<pre class="sage cell-code"><code>B.degree_sequence()</code></pre>
<div class="cell-output cell-output-display" data-execution_count="78">
<pre><code>[3, 3, 2, 1, 1]</code></pre>
</div>
</div>
<p><strong>Exercise</strong>: Notice that if you sum up the numbers in the degree list of <span class="math inline">\(B\)</span>, the number you obtain is exactly twice the number of edges of <span class="math inline">\(B\)</span>. Can you explain why this happened? Can you generalise this?</p>
<p>The next example is important, as we will keep coming back to it for the remaining of this section. To understand this example you will need to know the basics about binary numbers (don’t worry, they’re very simple). See <a href="https://www.mathsisfun.com/binary-number-system.html">this link</a> to learn the basics about binary.</p>
<p>Now, we can define the hypercube graph <span class="math inline">\(Q_n\)</span> as follows: The vertex set of <span class="math inline">\(Q_n\)</span> is all <span class="math inline">\(n\)</span>-digit binary numbers, and two vertices are adjacent if their binary representations differ in a single digit. <span class="math inline">\(Q_n\)</span> is known as the <em>hypercube graph</em> (which essentially means the <span class="math inline">\(n\)</span>-dimensional version of a cube). Let’s test this fact out. If we let <span class="math inline">\(n=3\)</span>, we should get the graph corresponding to a 3D cube.</p>
<div class="cell" data-execution_count="88">
<pre class="sage cell-code"><code>Q3 = graphs.CubeGraph(3)
P = Q3.graphplot(graph_border=True, vertex_size = 600)
P.show()</code></pre>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-11-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Hang on, a 3D cube has 8 vertices, right? Notice that something is off about the labeling of the middle vertex.</p>
<div class="cell" data-execution_count="89">
<pre class="sage cell-code"><code>Q3.order()</code></pre>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>8</code></pre>
</div>
</div>
<p>Sage is indeed correct. The reason why it seems like there are only 7 vertices in the graph is due to the way the graph is projected. Note that two vertices coincide on the middle of the plot. To fix this issue, we need change the <em>layout</em> of the graph.</p>
<div class="cell" data-execution_count="135">
<pre class="sage cell-code"><code>Q3 = graphs.CubeGraph(3)
Q3P = Q3.graphplot(graph_border=True, layout = "spring", vertex_size=500)
Q3P.show()
# Note if you run the code again, you will get a slighly different visual effect.</code></pre>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-13-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Now, that’s better, but can we make it even better?</p>
<div class="cell" data-execution_count="54">
<pre class="sage cell-code"><code>Q3.plot3d()</code></pre>
<div class="cell-output cell-output-display" data-execution_count="54">

<iframe srcdoc="<!DOCTYPE html>
<html>
<head>
<title></title>
<meta charset=&quot;utf-8&quot;>
<meta name=viewport content=&quot;width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0&quot;>
<style>

    body { margin: 0px; overflow: hidden; }

    #menu-container { position: absolute; bottom: 30px; right: 40px; cursor: default; }

    #menu-message { position: absolute; bottom: 0px; right: 0px; white-space: nowrap;
                    display: none; background-color: #F5F5F5; padding: 10px; }

    #menu-content { position: absolute; bottom: 0px; right: 0px;
                    display: none; background-color: #F5F5F5; border-bottom: 1px solid black;
                    border-right: 1px solid black; border-left: 1px solid black; }

    #menu-content div { border-top: 1px solid black; padding: 10px; white-space: nowrap; }

    #menu-content div:hover { background-color: #FEFEFE; }

    .dark-theme #menu-container { color: white; }

    .dark-theme #menu-message { background-color: #181818; }

    .dark-theme #menu-content { background-color: #181818; border-color: white; }

    .dark-theme #menu-content div { border-color: white; }

    .dark-theme #menu-content div:hover { background-color: #303030; }

</style>

</head>

<body>

<script src=&quot;/nbextensions/threejs-sage/r122/three.min.js&quot;></script>
<script>
  if ( !window.THREE ) document.write(' \
<script src=&quot;https://cdn.jsdelivr.net/gh/sagemath/threejs-sage@r122/build/three.min.js&quot;><\/script> \
            ');
</script>
        
<script>

    var options = {&quot;animate&quot;: false, &quot;animationControls&quot;: true, &quot;aspectRatio&quot;: [1.0, 1.0, 1.0], &quot;autoScaling&quot;: [false, false, false], &quot;autoPlay&quot;: true, &quot;axes&quot;: false, &quot;axesLabels&quot;: false, &quot;axesLabelsStyle&quot;: null, &quot;decimals&quot;: 2, &quot;delay&quot;: 20, &quot;frame&quot;: false, &quot;loop&quot;: true, &quot;projection&quot;: &quot;perspective&quot;, &quot;theme&quot;: &quot;light&quot;, &quot;viewpoint&quot;: false};
    var animate = options.animate;

    if ( options.theme === 'dark' )
        document.body.className = 'dark-theme';

    var scene = new THREE.Scene();

    var renderer = new THREE.WebGLRenderer( { antialias: true, preserveDrawingBuffer: true } );
    renderer.setPixelRatio( window.devicePixelRatio );
    renderer.setSize( window.innerWidth, window.innerHeight );
    renderer.setClearColor( options.theme === 'dark' ? 0 : 0xffffff, 1 );
    document.body.appendChild( renderer.domElement );

    var b = [{&quot;x&quot;:0.94, &quot;y&quot;:-0.8106979363375113, &quot;z&quot;:-0.9655550687444878}, {&quot;x&quot;:2.831189182513973, &quot;y&quot;:0.8107900055026702, &quot;z&quot;:0.9573280277017415}]; // bounds

    if ( b[0].x === b[1].x ) {
        b[0].x -= 1;
        b[1].x += 1;
    }
    if ( b[0].y === b[1].y ) {
        b[0].y -= 1;
        b[1].y += 1;
    }
    if ( b[0].z === b[1].z ) {
        b[0].z -= 1;
        b[1].z += 1;
    }

    var rxRange = Math.sqrt( Math.pow( b[1].z - b[0].z, 2 )
                            + Math.pow( b[1].y - b[0].y, 2 ) );
    var ryRange = Math.sqrt( Math.pow( b[1].x - b[0].x, 2 )
                            + Math.pow( b[1].z - b[0].z, 2 ) );
    var rzRange = Math.sqrt( Math.pow( b[1].x - b[0].x, 2 )
                            + Math.pow( b[1].y - b[0].y, 2 ) );
    var xRange = b[1].x - b[0].x;
    var yRange = b[1].y - b[0].y;
    var zRange = b[1].z - b[0].z;

    var ar = options.aspectRatio;
    var a = [ ar[0], ar[1], ar[2] ]; // aspect multipliers

    var autoScaling = options.autoScaling;
    var autoAspect = 2.5;
    if ( xRange > autoAspect * rxRange &amp;&amp; autoScaling[0] ) a[0] = autoAspect * rxRange / xRange;
    if ( yRange > autoAspect * ryRange &amp;&amp; autoScaling[1] ) a[1] = autoAspect * ryRange / yRange;
    if ( zRange > autoAspect * rzRange &amp;&amp; autoScaling[2] ) a[2] = autoAspect * rzRange / zRange;

    // Distance from (xMid,yMid,zMid) to any corner of the bounding box, after applying aspectRatio
    var midToCorner = Math.sqrt( a[0]*a[0]*xRange*xRange + a[1]*a[1]*yRange*yRange + a[2]*a[2]*zRange*zRange ) / 2;

    var xMid = ( b[0].x + b[1].x ) / 2;
    var yMid = ( b[0].y + b[1].y ) / 2;
    var zMid = ( b[0].z + b[1].z ) / 2;

    var box = new THREE.Geometry();
    box.vertices.push( new THREE.Vector3( a[0]*b[0].x, a[1]*b[0].y, a[2]*b[0].z ) );
    box.vertices.push( new THREE.Vector3( a[0]*b[1].x, a[1]*b[1].y, a[2]*b[1].z ) );
    var boxMesh = new THREE.Line( box );
    var boxColor = options.theme === 'dark' ? 'white' : 'black';
    if ( options.frame ) scene.add( new THREE.BoxHelper( boxMesh, boxColor ) );

    if ( options.axesLabels ) {

        var d = options.decimals; // decimals
        var offsetRatio = 0.1;
        var al = options.axesLabels;
        var als = options.axesLabelsStyle || [{}, {}, {}];

        var offset = offsetRatio * a[1]*( b[1].y - b[0].y );
        var xm = xMid.toFixed(d);
        if ( /^-0.?0*$/.test(xm) ) xm = xm.substr(1);
        addLabel( al[0] + '=' + xm, a[0]*xMid, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );
        addLabel( ( b[0].x ).toFixed(d), a[0]*b[0].x, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );
        addLabel( ( b[1].x ).toFixed(d), a[0]*b[1].x, a[1]*b[1].y+offset, a[2]*b[0].z, als[0] );

        var offset = offsetRatio * a[0]*( b[1].x - b[0].x );
        var ym = yMid.toFixed(d);
        if ( /^-0.?0*$/.test(ym) ) ym = ym.substr(1);
        addLabel( al[1] + '=' + ym, a[0]*b[1].x+offset, a[1]*yMid, a[2]*b[0].z, als[1] );
        addLabel( ( b[0].y ).toFixed(d), a[0]*b[1].x+offset, a[1]*b[0].y, a[2]*b[0].z, als[1] );
        addLabel( ( b[1].y ).toFixed(d), a[0]*b[1].x+offset, a[1]*b[1].y, a[2]*b[0].z, als[1] );

        var offset = offsetRatio * a[1]*( b[1].y - b[0].y );
        var zm = zMid.toFixed(d);
        if ( /^-0.?0*$/.test(zm) ) zm = zm.substr(1);
        addLabel( al[2] + '=' + zm, a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*zMid, als[2] );
        addLabel( ( b[0].z ).toFixed(d), a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*b[0].z, als[2] );
        addLabel( ( b[1].z ).toFixed(d), a[0]*b[1].x, a[1]*b[0].y-offset, a[2]*b[1].z, als[2] );

    }

    function addLabel( text, x, y, z, style ) {

        var color = style.color || 'black';
        var fontSize = style.fontSize || 14;
        var fontFamily = style.fontFamily || 'monospace';
        var fontStyle = style.fontStyle || 'normal';
        var fontWeight = style.fontWeight || 'normal';
        var opacity = style.opacity || 1;

        if ( options.theme === 'dark' )
            if ( color === 'black' || color === '#000000' )
                color = 'white';

        if ( Array.isArray( fontStyle ) ) {
            fontFamily = fontFamily.map( function( f ) {
                // Need to put quotes around fonts that have whitespace in their names.
                return /\s/.test( f ) ? '&quot;' + f + '&quot;' : f;
            }).join(', ');
        }

        var canvas = document.createElement( 'canvas' );
        var context = canvas.getContext( '2d' );
        var pixelRatio = Math.round( window.devicePixelRatio );

        // For example: italic bold 20px &quot;Times New Roman&quot;, Georgia, serif
        var font = [fontStyle, fontWeight, fontSize + 'px', fontFamily].join(' ');

        context.font = font;
        var width = context.measureText( text ).width;
        var height = fontSize;

        // The dimensions of the canvas's underlying image data need to be powers
        // of two in order for the resulting texture to support mipmapping.
        canvas.width = THREE.MathUtils.ceilPowerOfTwo( width * pixelRatio );
        canvas.height = THREE.MathUtils.ceilPowerOfTwo( height * pixelRatio );

        // Re-compute the unscaled dimensions after the power of two conversion.
        width = canvas.width / pixelRatio;
        height = canvas.height / pixelRatio;

        canvas.style.width = width + 'px';
        canvas.style.height = height + 'px';

        context.scale( pixelRatio, pixelRatio );
        context.fillStyle = color;
        context.font = font; // Must be set again after measureText.
        context.textAlign = 'center';
        context.textBaseline = 'middle';
        context.fillText( text, width/2, height/2 );

        var texture = new THREE.Texture( canvas );
        texture.needsUpdate = true;

        var materialOptions = { map: texture, sizeAttenuation: false, depthWrite: false };
        if ( opacity < 1 ) {
            // Setting opacity=1 would cause the texture's alpha component to be
            // discarded, giving the text a black background instead of the
            // background being transparent.
            materialOptions.opacity = opacity;
        }
        var sprite = new THREE.Sprite( new THREE.SpriteMaterial( materialOptions ) );
        sprite.position.set( x, y, z );

        // Scaling factor, chosen somewhat arbitrarily so that the size of the text
        // is consistent with previously generated plots.
        var scale = 1/625;
        if ( options.projection === 'orthographic' ) {
            scale = midToCorner/256; // Needs to scale along with the plot itself.
        }
        sprite.scale.set( scale * width, scale * height, 1 );

        scene.add( sprite );

        return sprite;

    }

    if ( options.axes ) scene.add( new THREE.AxesHelper( Math.min( a[0]*b[1].x, a[1]*b[1].y, a[2]*b[1].z ) ) );

    var camera = createCamera();
    camera.up.set( 0, 0, 1 );
    camera.position.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );

    // camera is positioned so that the line from the camera to the center
    // of the bounding sphere of the objects makes an angle of 60 degrees with x-axis
    // and an angle of 30 degrees with z-axis and the field of view of the camera looking
    // at the center has an angle of 45 degrees.
    const sin8 = Math.sin(Math.PI / 8);
    const sin5 = Math.sin(Math.PI / 5);
    const cos5 = Math.cos(Math.PI / 5);
    const sin3 = Math.sin(Math.PI / 3);
    const cos3 = Math.cos(Math.PI / 3);
    var r = midToCorner / sin8;
    var offset = new THREE.Vector3( r * sin3 * cos5, r * sin3 * sin5, r * cos3 );

    if ( options.viewpoint ) {

        var aa = options.viewpoint;
        var axis = new THREE.Vector3( aa[0][0], aa[0][1], aa[0][2] ).normalize();
        var angle = aa[1] * Math.PI / 180;
        var q = new THREE.Quaternion().setFromAxisAngle( axis, angle ).inverse();

        offset.set( 0, 0, offset.length() );
        offset.applyQuaternion( q );

    }

    camera.position.add( offset );

    function createCamera() {

        var aspect = window.innerWidth / window.innerHeight;

        // Scale the near and far clipping planes along with the overall plot size.
        var nearClip = 0.01 * midToCorner;
        var farClip = 100 * midToCorner;

        if ( options.projection === 'orthographic' ) {
            var camera = new THREE.OrthographicCamera( -1, 1, 1, -1, -farClip, farClip );
            updateCameraAspect( camera, aspect );
            return camera;
        }

        return new THREE.PerspectiveCamera( 45, aspect, nearClip, farClip );

    }

    function updateCameraAspect( camera, aspect ) {

        if ( camera.isPerspectiveCamera ) {
            camera.aspect = aspect;
        } else if ( camera.isOrthographicCamera ) {
            // Fit the camera frustum to the bounding box's diagonal so that the entire plot fits
            // within at the default zoom level and camera position.
            if ( aspect > 1 ) { // Wide window
                camera.top = midToCorner;
                camera.right = midToCorner * aspect;
            } else { // Tall or square window
                camera.top = midToCorner / aspect;
                camera.right = midToCorner;
            }
            camera.bottom = -camera.top;
            camera.left = -camera.right;
        }

        camera.updateProjectionMatrix();

    }

    var lights = [{&quot;x&quot;:-5, &quot;y&quot;:3, &quot;z&quot;:0, &quot;color&quot;:&quot;#7f7f7f&quot;, &quot;parent&quot;:&quot;camera&quot;}];
    for ( var i=0 ; i < lights.length ; i++ ) {
        var light = new THREE.DirectionalLight( lights[i].color, 1 );
        light.position.set( a[0]*lights[i].x, a[1]*lights[i].y, a[2]*lights[i].z );
        if ( lights[i].parent === 'camera' ) {
            light.target.position.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );
            scene.add( light.target );
            camera.add( light );
        } else scene.add( light );
    }
    scene.add( camera );

    var ambient = {&quot;color&quot;:&quot;#7f7f7f&quot;};
    scene.add( new THREE.AmbientLight( ambient.color, 1 ) );

    var controls = new THREE.OrbitControls( camera, renderer.domElement );
    controls.target.set( a[0]*xMid, a[1]*yMid, a[2]*zMid );
    controls.addEventListener( 'change', function() { if ( !animate ) render(); } );

    window.addEventListener( 'resize', function() {

        renderer.setSize( window.innerWidth, window.innerHeight );
        updateCameraAspect( camera, window.innerWidth / window.innerHeight );
        if ( window.rescaleFatLines ) rescaleFatLines();
        if ( !animate ) render();

    } );

    var texts = [];
    for ( var i=0 ; i < texts.length ; i++ ) addText( texts[i] );

    function addText( json ) {
        var sprite = addLabel( json.text, a[0]*json.x, a[1]*json.y, a[2]*json.z, json );
        sprite.userData = json;
    }

    var points = [];
    for ( var i=0 ; i < points.length ; i++ ) addPoint( points[i] );

    function addPoint( json ) {

        var geometry = new THREE.Geometry();
        var v = json.point;
        geometry.vertices.push( new THREE.Vector3( a[0]*v[0], a[1]*v[1], a[2]*v[2] ) );

        var canvas = document.createElement( 'canvas' );
        canvas.width = 128;
        canvas.height = 128;

        var context = canvas.getContext( '2d' );
        context.arc( 64, 64, 64, 0, 2 * Math.PI );
        context.fillStyle = json.color;
        context.fill();

        var texture = new THREE.Texture( canvas );
        texture.needsUpdate = true;

        var transparent = json.opacity < 1 ? true : false;
        var size = camera.isOrthographicCamera ? json.size : json.size/100;
        var material = new THREE.PointsMaterial( { size: size, map: texture,
                                                   transparent: transparent, opacity: json.opacity,
                                                   alphaTest: .1 } );

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var mesh = new THREE.Points( geometry, material );
        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    var lines = [];
    for ( var i=0 ; i < lines.length ; i++ ) addLine( lines[i] );

    function addLine( json ) {

        var geometry = new THREE.Geometry();
        for ( var i=0 ; i < json.points.length ; i++ ) {
            var v = json.points[i];
            geometry.vertices.push( new THREE.Vector3( a[0]*v[0], a[1]*v[1], a[2]*v[2] ) );
        }

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var transparent = json.opacity < 1 ? true : false;
        var materialOptions = { color: json.color, linewidth: json.linewidth,
                                transparent: transparent, opacity: json.opacity };

        var mesh;
        if ( json.linewidth > 1 &amp;&amp; window.createFatLineStrip ) {
            mesh = createFatLineStrip( geometry, materialOptions );
        } else {
            var material = new THREE.LineBasicMaterial( materialOptions );
            mesh = new THREE.Line( geometry, material );
        }

        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    var surfaces = [{&quot;vertices&quot;: [{&quot;x&quot;: 0.9999999999999999, &quot;y&quot;: 0.3304376485721625, &quot;z&quot;: 0.18622497850706005}, {&quot;x&quot;: 1.015, &quot;y&quot;: 0.3564184106856957, &quot;z&quot;: 0.19426345427999372}, {&quot;x&quot;: 1.0299999999999998, &quot;y&quot;: 0.3304376485721625, &quot;z&quot;: 0.19426345427999372}, {&quot;x&quot;: 0.9849999999999999, &quot;y&quot;: 0.3564184106856957, &quot;z&quot;: 0.19426345427999372}, {&quot;x&quot;: 0.9699999999999999, &quot;y&quot;: 0.3304376485721625, &quot;z&quot;: 0.19426345427999372}, {&quot;x&quot;: 0.9849999999999999, &quot;y&quot;: 0.30445688645862934, &quot;z&quot;: 0.19426345427999372}, {&quot;x&quot;: 1.015, &quot;y&quot;: 0.30445688645862934, &quot;z&quot;: 0.19426345427999372}, {&quot;x&quot;: 1.025980762113533, &quot;y&quot;: 0.3754376485721625, &quot;z&quot;: 0.21622497850706004}, {&quot;x&quot;: 1.0519615242270661, &quot;y&quot;: 0.3304376485721625, &quot;z&quot;: 0.21622497850706004}, {&quot;x&quot;: 0.9740192378864667, &quot;y&quot;: 0.3754376485721625, &quot;z&quot;: 0.21622497850706004}, {&quot;x&quot;: 0.9480384757729335, &quot;y&quot;: 0.3304376485721625, &quot;z&quot;: 0.21622497850706004}, {&quot;x&quot;: 0.9740192378864667, &quot;y&quot;: 0.28543764857216253, &quot;z&quot;: 0.21622497850706004}, {&quot;x&quot;: 1.025980762113533, &quot;y&quot;: 0.28543764857216253, &quot;z&quot;: 0.21622497850706004}, {&quot;x&quot;: 1.0299999999999998, &quot;y&quot;: 0.3823991727992288, &quot;z&quot;: 0.24622497850706004}, {&quot;x&quot;: 1.0599999999999998, &quot;y&quot;: 0.3304376485721625, &quot;z&quot;: 0.24622497850706004}, {&quot;x&quot;: 0.9699999999999999, &quot;y&quot;: 0.38239917279922886, &quot;z&quot;: 0.24622497850706004}, {&quot;x&quot;: 0.94, &quot;y&quot;: 0.3304376485721625, &quot;z&quot;: 0.24622497850706004}, {&quot;x&quot;: 0.9699999999999999, &quot;y&quot;: 0.2784761243450962, &quot;z&quot;: 0.24622497850706004}, {&quot;x&quot;: 1.0299999999999998, &quot;y&quot;: 0.2784761243450962, &quot;z&quot;: 0.24622497850706004}, {&quot;x&quot;: 1.025980762113533, &quot;y&quot;: 0.3754376485721625, &quot;z&quot;: 0.27622497850706}, {&quot;x&quot;: 1.0519615242270661, &quot;y&quot;: 0.3304376485721625, &quot;z&quot;: 0.27622497850706}, {&quot;x&quot;: 0.9740192378864667, &quot;y&quot;: 0.37543764857216255, &quot;z&quot;: 0.27622497850706}, {&quot;x&quot;: 0.9480384757729335, &quot;y&quot;: 0.3304376485721625, &quot;z&quot;: 0.27622497850706}, {&quot;x&quot;: 0.9740192378864667, &quot;y&quot;: 0.28543764857216253, &quot;z&quot;: 0.27622497850706}, {&quot;x&quot;: 1.025980762113533, &quot;y&quot;: 0.28543764857216253, &quot;z&quot;: 0.27622497850706}, {&quot;x&quot;: 1.015, &quot;y&quot;: 0.3564184106856957, &quot;z&quot;: 0.2981865027341264}, {&quot;x&quot;: 1.0299999999999998, &quot;y&quot;: 0.3304376485721625, &quot;z&quot;: 0.2981865027341264}, {&quot;x&quot;: 0.9849999999999999, &quot;y&quot;: 0.3564184106856957, &quot;z&quot;: 0.2981865027341264}, {&quot;x&quot;: 0.9699999999999999, &quot;y&quot;: 0.3304376485721625, &quot;z&quot;: 0.2981865027341264}, {&quot;x&quot;: 0.9849999999999999, &quot;y&quot;: 0.30445688645862934, &quot;z&quot;: 0.2981865027341264}, {&quot;x&quot;: 1.015, &quot;y&quot;: 0.30445688645862934, &quot;z&quot;: 0.2981865027341264}, {&quot;x&quot;: 0.9999999999999999, &quot;y&quot;: 0.3304376485721625, &quot;z&quot;: 0.30622497850706004}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 6, 5], [0, 2, 6], [2, 1, 7, 8], [1, 3, 9, 7], [3, 4, 10, 9], [4, 5, 11, 10], [5, 6, 12, 11], [6, 2, 8, 12], [8, 7, 13, 14], [7, 9, 15, 13], [9, 10, 16, 15], [10, 11, 17, 16], [11, 12, 18, 17], [12, 8, 14, 18], [14, 13, 19, 20], [13, 15, 21, 19], [15, 16, 22, 21], [16, 17, 23, 22], [17, 18, 24, 23], [18, 14, 20, 24], [20, 19, 25, 26], [19, 21, 27, 25], [21, 22, 28, 27], [22, 23, 29, 28], [23, 24, 30, 29], [24, 20, 26, 30], [26, 25, 31], [25, 27, 31], [27, 28, 31], [28, 29, 31], [29, 30, 31], [30, 26, 31]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 2.771189182513973, &quot;y&quot;: -0.3218451670884835, &quot;z&quot;: -0.3114082762046739}, {&quot;x&quot;: 2.786189182513973, &quot;y&quot;: -0.2958644049749503, &quot;z&quot;: -0.3033698004317402}, {&quot;x&quot;: 2.8011891825139728, &quot;y&quot;: -0.3218451670884835, &quot;z&quot;: -0.3033698004317402}, {&quot;x&quot;: 2.756189182513973, &quot;y&quot;: -0.2958644049749503, &quot;z&quot;: -0.3033698004317402}, {&quot;x&quot;: 2.741189182513973, &quot;y&quot;: -0.3218451670884835, &quot;z&quot;: -0.3033698004317402}, {&quot;x&quot;: 2.756189182513973, &quot;y&quot;: -0.3478259292020166, &quot;z&quot;: -0.3033698004317402}, {&quot;x&quot;: 2.786189182513973, &quot;y&quot;: -0.34782592920201666, &quot;z&quot;: -0.3033698004317402}, {&quot;x&quot;: 2.7971699446275062, &quot;y&quot;: -0.2768451670884835, &quot;z&quot;: -0.2814082762046739}, {&quot;x&quot;: 2.823150706741039, &quot;y&quot;: -0.3218451670884835, &quot;z&quot;: -0.2814082762046739}, {&quot;x&quot;: 2.7452084204004397, &quot;y&quot;: -0.2768451670884835, &quot;z&quot;: -0.2814082762046739}, {&quot;x&quot;: 2.719227658286907, &quot;y&quot;: -0.3218451670884835, &quot;z&quot;: -0.2814082762046739}, {&quot;x&quot;: 2.7452084204004397, &quot;y&quot;: -0.36684516708848347, &quot;z&quot;: -0.2814082762046739}, {&quot;x&quot;: 2.7971699446275062, &quot;y&quot;: -0.36684516708848347, &quot;z&quot;: -0.2814082762046739}, {&quot;x&quot;: 2.8011891825139728, &quot;y&quot;: -0.2698836428614172, &quot;z&quot;: -0.2514082762046739}, {&quot;x&quot;: 2.831189182513973, &quot;y&quot;: -0.3218451670884835, &quot;z&quot;: -0.2514082762046739}, {&quot;x&quot;: 2.741189182513973, &quot;y&quot;: -0.26988364286141714, &quot;z&quot;: -0.2514082762046739}, {&quot;x&quot;: 2.711189182513973, &quot;y&quot;: -0.3218451670884835, &quot;z&quot;: -0.2514082762046739}, {&quot;x&quot;: 2.741189182513973, &quot;y&quot;: -0.3738066913155498, &quot;z&quot;: -0.2514082762046739}, {&quot;x&quot;: 2.8011891825139728, &quot;y&quot;: -0.3738066913155498, &quot;z&quot;: -0.2514082762046739}, {&quot;x&quot;: 2.7971699446275062, &quot;y&quot;: -0.2768451670884835, &quot;z&quot;: -0.22140827620467388}, {&quot;x&quot;: 2.823150706741039, &quot;y&quot;: -0.3218451670884835, &quot;z&quot;: -0.22140827620467388}, {&quot;x&quot;: 2.7452084204004397, &quot;y&quot;: -0.2768451670884835, &quot;z&quot;: -0.22140827620467388}, {&quot;x&quot;: 2.719227658286907, &quot;y&quot;: -0.3218451670884835, &quot;z&quot;: -0.22140827620467388}, {&quot;x&quot;: 2.7452084204004397, &quot;y&quot;: -0.36684516708848347, &quot;z&quot;: -0.22140827620467388}, {&quot;x&quot;: 2.7971699446275062, &quot;y&quot;: -0.36684516708848347, &quot;z&quot;: -0.22140827620467388}, {&quot;x&quot;: 2.786189182513973, &quot;y&quot;: -0.2958644049749503, &quot;z&quot;: -0.19944675197760756}, {&quot;x&quot;: 2.8011891825139728, &quot;y&quot;: -0.3218451670884835, &quot;z&quot;: -0.19944675197760756}, {&quot;x&quot;: 2.756189182513973, &quot;y&quot;: -0.2958644049749503, &quot;z&quot;: -0.19944675197760756}, {&quot;x&quot;: 2.741189182513973, &quot;y&quot;: -0.3218451670884835, &quot;z&quot;: -0.19944675197760756}, {&quot;x&quot;: 2.756189182513973, &quot;y&quot;: -0.3478259292020166, &quot;z&quot;: -0.19944675197760756}, {&quot;x&quot;: 2.786189182513973, &quot;y&quot;: -0.34782592920201666, &quot;z&quot;: -0.19944675197760756}, {&quot;x&quot;: 2.771189182513973, &quot;y&quot;: -0.3218451670884835, &quot;z&quot;: -0.19140827620467388}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 6, 5], [0, 2, 6], [2, 1, 7, 8], [1, 3, 9, 7], [3, 4, 10, 9], [4, 5, 11, 10], [5, 6, 12, 11], [6, 2, 8, 12], [8, 7, 13, 14], [7, 9, 15, 13], [9, 10, 16, 15], [10, 11, 17, 16], [11, 12, 18, 17], [12, 8, 14, 18], [14, 13, 19, 20], [13, 15, 21, 19], [15, 16, 22, 21], [16, 17, 23, 22], [17, 18, 24, 23], [18, 14, 20, 24], [20, 19, 25, 26], [19, 21, 27, 25], [21, 22, 28, 27], [22, 23, 29, 28], [23, 24, 30, 29], [24, 20, 26, 30], [26, 25, 31], [25, 27, 31], [27, 28, 31], [28, 29, 31], [29, 30, 31], [30, 26, 31]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 1.299538452670126, &quot;y&quot;: -0.7506979363375114, &quot;z&quot;: -0.028004479073369955}, {&quot;x&quot;: 1.3145384526701258, &quot;y&quot;: -0.7247171742239782, &quot;z&quot;: -0.019966003300436276}, {&quot;x&quot;: 1.329538452670126, &quot;y&quot;: -0.7506979363375114, &quot;z&quot;: -0.019966003300436276}, {&quot;x&quot;: 1.284538452670126, &quot;y&quot;: -0.7247171742239782, &quot;z&quot;: -0.019966003300436276}, {&quot;x&quot;: 1.2695384526701259, &quot;y&quot;: -0.7506979363375114, &quot;z&quot;: -0.019966003300436276}, {&quot;x&quot;: 1.284538452670126, &quot;y&quot;: -0.7766786984510445, &quot;z&quot;: -0.019966003300436276}, {&quot;x&quot;: 1.3145384526701258, &quot;y&quot;: -0.7766786984510445, &quot;z&quot;: -0.019966003300436276}, {&quot;x&quot;: 1.325519214783659, &quot;y&quot;: -0.7056979363375113, &quot;z&quot;: 0.001995520926630044}, {&quot;x&quot;: 1.3514999768971923, &quot;y&quot;: -0.7506979363375114, &quot;z&quot;: 0.001995520926630044}, {&quot;x&quot;: 1.2735576905565928, &quot;y&quot;: -0.7056979363375113, &quot;z&quot;: 0.001995520926630044}, {&quot;x&quot;: 1.2475769284430596, &quot;y&quot;: -0.7506979363375114, &quot;z&quot;: 0.001995520926630044}, {&quot;x&quot;: 1.2735576905565926, &quot;y&quot;: -0.7956979363375113, &quot;z&quot;: 0.001995520926630044}, {&quot;x&quot;: 1.325519214783659, &quot;y&quot;: -0.7956979363375114, &quot;z&quot;: 0.001995520926630044}, {&quot;x&quot;: 1.329538452670126, &quot;y&quot;: -0.698736412110445, &quot;z&quot;: 0.03199552092663004}, {&quot;x&quot;: 1.359538452670126, &quot;y&quot;: -0.7506979363375114, &quot;z&quot;: 0.03199552092663004}, {&quot;x&quot;: 1.2695384526701259, &quot;y&quot;: -0.698736412110445, &quot;z&quot;: 0.03199552092663004}, {&quot;x&quot;: 1.2395384526701259, &quot;y&quot;: -0.7506979363375114, &quot;z&quot;: 0.03199552092663004}, {&quot;x&quot;: 1.2695384526701259, &quot;y&quot;: -0.8026594605645777, &quot;z&quot;: 0.03199552092663004}, {&quot;x&quot;: 1.329538452670126, &quot;y&quot;: -0.8026594605645777, &quot;z&quot;: 0.03199552092663004}, {&quot;x&quot;: 1.325519214783659, &quot;y&quot;: -0.7056979363375113, &quot;z&quot;: 0.061995520926630035}, {&quot;x&quot;: 1.3514999768971923, &quot;y&quot;: -0.7506979363375114, &quot;z&quot;: 0.061995520926630035}, {&quot;x&quot;: 1.2735576905565928, &quot;y&quot;: -0.7056979363375113, &quot;z&quot;: 0.061995520926630035}, {&quot;x&quot;: 1.2475769284430596, &quot;y&quot;: -0.7506979363375114, &quot;z&quot;: 0.061995520926630035}, {&quot;x&quot;: 1.2735576905565926, &quot;y&quot;: -0.7956979363375114, &quot;z&quot;: 0.061995520926630035}, {&quot;x&quot;: 1.325519214783659, &quot;y&quot;: -0.7956979363375114, &quot;z&quot;: 0.061995520926630035}, {&quot;x&quot;: 1.3145384526701258, &quot;y&quot;: -0.7247171742239782, &quot;z&quot;: 0.08395704515369637}, {&quot;x&quot;: 1.329538452670126, &quot;y&quot;: -0.7506979363375114, &quot;z&quot;: 0.08395704515369637}, {&quot;x&quot;: 1.284538452670126, &quot;y&quot;: -0.7247171742239782, &quot;z&quot;: 0.08395704515369637}, {&quot;x&quot;: 1.2695384526701259, &quot;y&quot;: -0.7506979363375114, &quot;z&quot;: 0.08395704515369637}, {&quot;x&quot;: 1.284538452670126, &quot;y&quot;: -0.7766786984510445, &quot;z&quot;: 0.08395704515369637}, {&quot;x&quot;: 1.3145384526701258, &quot;y&quot;: -0.7766786984510445, &quot;z&quot;: 0.08395704515369637}, {&quot;x&quot;: 1.299538452670126, &quot;y&quot;: -0.7506979363375114, &quot;z&quot;: 0.09199552092663005}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 6, 5], [0, 2, 6], [2, 1, 7, 8], [1, 3, 9, 7], [3, 4, 10, 9], [4, 5, 11, 10], [5, 6, 12, 11], [6, 2, 8, 12], [8, 7, 13, 14], [7, 9, 15, 13], [9, 10, 16, 15], [10, 11, 17, 16], [11, 12, 18, 17], [12, 8, 14, 18], [14, 13, 19, 20], [13, 15, 21, 19], [15, 16, 22, 21], [16, 17, 23, 22], [17, 18, 24, 23], [18, 14, 20, 24], [20, 19, 25, 26], [19, 21, 27, 25], [21, 22, 28, 27], [22, 23, 29, 28], [23, 24, 30, 29], [24, 20, 26, 30], [26, 25, 31], [25, 27, 31], [27, 28, 31], [28, 29, 31], [29, 30, 31], [30, 26, 31]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 2.480218919015423, &quot;y&quot;: 0.7507900055026703, &quot;z&quot;: -0.08958164939459591}, {&quot;x&quot;: 2.4952189190154233, &quot;y&quot;: 0.7767707676162035, &quot;z&quot;: -0.08154317362166223}, {&quot;x&quot;: 2.510218919015423, &quot;y&quot;: 0.7507900055026703, &quot;z&quot;: -0.08154317362166223}, {&quot;x&quot;: 2.465218919015423, &quot;y&quot;: 0.7767707676162035, &quot;z&quot;: -0.08154317362166223}, {&quot;x&quot;: 2.4502189190154233, &quot;y&quot;: 0.7507900055026703, &quot;z&quot;: -0.08154317362166223}, {&quot;x&quot;: 2.465218919015423, &quot;y&quot;: 0.7248092433891371, &quot;z&quot;: -0.08154317362166223}, {&quot;x&quot;: 2.4952189190154233, &quot;y&quot;: 0.7248092433891371, &quot;z&quot;: -0.08154317362166223}, {&quot;x&quot;: 2.5061996811289564, &quot;y&quot;: 0.7957900055026703, &quot;z&quot;: -0.05958164939459591}, {&quot;x&quot;: 2.5321804432424893, &quot;y&quot;: 0.7507900055026703, &quot;z&quot;: -0.05958164939459591}, {&quot;x&quot;: 2.45423815690189, &quot;y&quot;: 0.7957900055026703, &quot;z&quot;: -0.05958164939459591}, {&quot;x&quot;: 2.428257394788357, &quot;y&quot;: 0.7507900055026703, &quot;z&quot;: -0.05958164939459591}, {&quot;x&quot;: 2.45423815690189, &quot;y&quot;: 0.7057900055026703, &quot;z&quot;: -0.05958164939459591}, {&quot;x&quot;: 2.5061996811289564, &quot;y&quot;: 0.7057900055026702, &quot;z&quot;: -0.05958164939459591}, {&quot;x&quot;: 2.510218919015423, &quot;y&quot;: 0.8027515297297366, &quot;z&quot;: -0.029581649394595913}, {&quot;x&quot;: 2.540218919015423, &quot;y&quot;: 0.7507900055026703, &quot;z&quot;: -0.029581649394595913}, {&quot;x&quot;: 2.4502189190154233, &quot;y&quot;: 0.8027515297297366, &quot;z&quot;: -0.029581649394595913}, {&quot;x&quot;: 2.420218919015423, &quot;y&quot;: 0.7507900055026703, &quot;z&quot;: -0.029581649394595913}, {&quot;x&quot;: 2.4502189190154233, &quot;y&quot;: 0.6988284812756039, &quot;z&quot;: -0.029581649394595913}, {&quot;x&quot;: 2.510218919015423, &quot;y&quot;: 0.6988284812756039, &quot;z&quot;: -0.029581649394595913}, {&quot;x&quot;: 2.5061996811289564, &quot;y&quot;: 0.7957900055026703, &quot;z&quot;: 0.00041835060540407545}, {&quot;x&quot;: 2.5321804432424893, &quot;y&quot;: 0.7507900055026703, &quot;z&quot;: 0.00041835060540407545}, {&quot;x&quot;: 2.45423815690189, &quot;y&quot;: 0.7957900055026703, &quot;z&quot;: 0.00041835060540407545}, {&quot;x&quot;: 2.428257394788357, &quot;y&quot;: 0.7507900055026703, &quot;z&quot;: 0.00041835060540407545}, {&quot;x&quot;: 2.45423815690189, &quot;y&quot;: 0.7057900055026702, &quot;z&quot;: 0.00041835060540407545}, {&quot;x&quot;: 2.5061996811289564, &quot;y&quot;: 0.7057900055026702, &quot;z&quot;: 0.00041835060540407545}, {&quot;x&quot;: 2.4952189190154233, &quot;y&quot;: 0.7767707676162035, &quot;z&quot;: 0.022379874832470406}, {&quot;x&quot;: 2.510218919015423, &quot;y&quot;: 0.7507900055026703, &quot;z&quot;: 0.022379874832470406}, {&quot;x&quot;: 2.465218919015423, &quot;y&quot;: 0.7767707676162035, &quot;z&quot;: 0.022379874832470406}, {&quot;x&quot;: 2.4502189190154233, &quot;y&quot;: 0.7507900055026703, &quot;z&quot;: 0.022379874832470406}, {&quot;x&quot;: 2.465218919015423, &quot;y&quot;: 0.7248092433891371, &quot;z&quot;: 0.022379874832470406}, {&quot;x&quot;: 2.4952189190154233, &quot;y&quot;: 0.7248092433891371, &quot;z&quot;: 0.022379874832470406}, {&quot;x&quot;: 2.480218919015423, &quot;y&quot;: 0.7507900055026703, &quot;z&quot;: 0.030418350605404085}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 6, 5], [0, 2, 6], [2, 1, 7, 8], [1, 3, 9, 7], [3, 4, 10, 9], [4, 5, 11, 10], [5, 6, 12, 11], [6, 2, 8, 12], [8, 7, 13, 14], [7, 9, 15, 13], [9, 10, 16, 15], [10, 11, 17, 16], [11, 12, 18, 17], [12, 8, 14, 18], [14, 13, 19, 20], [13, 15, 21, 19], [15, 16, 22, 21], [16, 17, 23, 22], [17, 18, 24, 23], [18, 14, 20, 24], [20, 19, 25, 26], [19, 21, 27, 25], [21, 22, 28, 27], [22, 23, 29, 28], [23, 24, 30, 29], [24, 20, 26, 30], [26, 25, 31], [25, 27, 31], [27, 28, 31], [28, 29, 31], [29, 30, 31], [30, 26, 31]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 1.5604677634153887, &quot;y&quot;: 0.6483195352508891, &quot;z&quot;: -0.7197940826978491}, {&quot;x&quot;: 1.5754677634153886, &quot;y&quot;: 0.6743002973644223, &quot;z&quot;: -0.7117556069249155}, {&quot;x&quot;: 1.5904677634153888, &quot;y&quot;: 0.6483195352508891, &quot;z&quot;: -0.7117556069249155}, {&quot;x&quot;: 1.5454677634153888, &quot;y&quot;: 0.6743002973644223, &quot;z&quot;: -0.7117556069249155}, {&quot;x&quot;: 1.5304677634153887, &quot;y&quot;: 0.6483195352508891, &quot;z&quot;: -0.7117556069249155}, {&quot;x&quot;: 1.5454677634153888, &quot;y&quot;: 0.622338773137356, &quot;z&quot;: -0.7117556069249155}, {&quot;x&quot;: 1.5754677634153886, &quot;y&quot;: 0.622338773137356, &quot;z&quot;: -0.7117556069249155}, {&quot;x&quot;: 1.5864485255289218, &quot;y&quot;: 0.6933195352508892, &quot;z&quot;: -0.6897940826978491}, {&quot;x&quot;: 1.612429287642455, &quot;y&quot;: 0.6483195352508891, &quot;z&quot;: -0.6897940826978491}, {&quot;x&quot;: 1.5344870013018557, &quot;y&quot;: 0.6933195352508892, &quot;z&quot;: -0.6897940826978491}, {&quot;x&quot;: 1.5085062391883224, &quot;y&quot;: 0.6483195352508891, &quot;z&quot;: -0.6897940826978491}, {&quot;x&quot;: 1.5344870013018554, &quot;y&quot;: 0.6033195352508892, &quot;z&quot;: -0.6897940826978491}, {&quot;x&quot;: 1.5864485255289218, &quot;y&quot;: 0.6033195352508891, &quot;z&quot;: -0.6897940826978491}, {&quot;x&quot;: 1.5904677634153888, &quot;y&quot;: 0.7002810594779555, &quot;z&quot;: -0.6597940826978491}, {&quot;x&quot;: 1.6204677634153888, &quot;y&quot;: 0.6483195352508891, &quot;z&quot;: -0.6597940826978491}, {&quot;x&quot;: 1.5304677634153887, &quot;y&quot;: 0.7002810594779555, &quot;z&quot;: -0.6597940826978491}, {&quot;x&quot;: 1.5004677634153887, &quot;y&quot;: 0.6483195352508891, &quot;z&quot;: -0.6597940826978491}, {&quot;x&quot;: 1.5304677634153887, &quot;y&quot;: 0.5963580110238228, &quot;z&quot;: -0.6597940826978491}, {&quot;x&quot;: 1.5904677634153888, &quot;y&quot;: 0.5963580110238228, &quot;z&quot;: -0.6597940826978491}, {&quot;x&quot;: 1.5864485255289218, &quot;y&quot;: 0.6933195352508892, &quot;z&quot;: -0.6297940826978491}, {&quot;x&quot;: 1.612429287642455, &quot;y&quot;: 0.6483195352508891, &quot;z&quot;: -0.6297940826978491}, {&quot;x&quot;: 1.5344870013018557, &quot;y&quot;: 0.6933195352508892, &quot;z&quot;: -0.6297940826978491}, {&quot;x&quot;: 1.5085062391883224, &quot;y&quot;: 0.6483195352508891, &quot;z&quot;: -0.6297940826978491}, {&quot;x&quot;: 1.5344870013018554, &quot;y&quot;: 0.6033195352508891, &quot;z&quot;: -0.6297940826978491}, {&quot;x&quot;: 1.5864485255289218, &quot;y&quot;: 0.6033195352508891, &quot;z&quot;: -0.6297940826978491}, {&quot;x&quot;: 1.5754677634153886, &quot;y&quot;: 0.6743002973644223, &quot;z&quot;: -0.6078325584707828}, {&quot;x&quot;: 1.5904677634153888, &quot;y&quot;: 0.6483195352508891, &quot;z&quot;: -0.6078325584707828}, {&quot;x&quot;: 1.5454677634153888, &quot;y&quot;: 0.6743002973644223, &quot;z&quot;: -0.6078325584707828}, {&quot;x&quot;: 1.5304677634153887, &quot;y&quot;: 0.6483195352508891, &quot;z&quot;: -0.6078325584707828}, {&quot;x&quot;: 1.5454677634153888, &quot;y&quot;: 0.622338773137356, &quot;z&quot;: -0.6078325584707828}, {&quot;x&quot;: 1.5754677634153886, &quot;y&quot;: 0.622338773137356, &quot;z&quot;: -0.6078325584707828}, {&quot;x&quot;: 1.5604677634153887, &quot;y&quot;: 0.6483195352508891, &quot;z&quot;: -0.5997940826978492}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 6, 5], [0, 2, 6], [2, 1, 7, 8], [1, 3, 9, 7], [3, 4, 10, 9], [4, 5, 11, 10], [5, 6, 12, 11], [6, 2, 8, 12], [8, 7, 13, 14], [7, 9, 15, 13], [9, 10, 16, 15], [10, 11, 17, 16], [11, 12, 18, 17], [12, 8, 14, 18], [14, 13, 19, 20], [13, 15, 21, 19], [15, 16, 22, 21], [16, 17, 23, 22], [17, 18, 24, 23], [18, 14, 20, 24], [20, 19, 25, 26], [19, 21, 27, 25], [21, 22, 28, 27], [22, 23, 29, 28], [23, 24, 30, 29], [24, 20, 26, 30], [26, 25, 31], [25, 27, 31], [27, 28, 31], [28, 29, 31], [29, 30, 31], [30, 26, 31]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 1.930541154142837, &quot;y&quot;: 0.39855755803570936, &quot;z&quot;: 0.8373280277017416}, {&quot;x&quot;: 1.945541154142837, &quot;y&quot;: 0.42453832014924253, &quot;z&quot;: 0.8453665034746752}, {&quot;x&quot;: 1.960541154142837, &quot;y&quot;: 0.39855755803570936, &quot;z&quot;: 0.8453665034746752}, {&quot;x&quot;: 1.915541154142837, &quot;y&quot;: 0.42453832014924253, &quot;z&quot;: 0.8453665034746752}, {&quot;x&quot;: 1.900541154142837, &quot;y&quot;: 0.39855755803570936, &quot;z&quot;: 0.8453665034746752}, {&quot;x&quot;: 1.915541154142837, &quot;y&quot;: 0.3725767959221762, &quot;z&quot;: 0.8453665034746752}, {&quot;x&quot;: 1.945541154142837, &quot;y&quot;: 0.3725767959221762, &quot;z&quot;: 0.8453665034746752}, {&quot;x&quot;: 1.95652191625637, &quot;y&quot;: 0.44355755803570934, &quot;z&quot;: 0.8673280277017416}, {&quot;x&quot;: 1.9825026783699033, &quot;y&quot;: 0.39855755803570936, &quot;z&quot;: 0.8673280277017416}, {&quot;x&quot;: 1.904560392029304, &quot;y&quot;: 0.44355755803570934, &quot;z&quot;: 0.8673280277017416}, {&quot;x&quot;: 1.8785796299157707, &quot;y&quot;: 0.39855755803570936, &quot;z&quot;: 0.8673280277017416}, {&quot;x&quot;: 1.9045603920293037, &quot;y&quot;: 0.3535575580357094, &quot;z&quot;: 0.8673280277017416}, {&quot;x&quot;: 1.95652191625637, &quot;y&quot;: 0.3535575580357094, &quot;z&quot;: 0.8673280277017416}, {&quot;x&quot;: 1.960541154142837, &quot;y&quot;: 0.45051908226277565, &quot;z&quot;: 0.8973280277017416}, {&quot;x&quot;: 1.990541154142837, &quot;y&quot;: 0.39855755803570936, &quot;z&quot;: 0.8973280277017416}, {&quot;x&quot;: 1.900541154142837, &quot;y&quot;: 0.4505190822627757, &quot;z&quot;: 0.8973280277017416}, {&quot;x&quot;: 1.870541154142837, &quot;y&quot;: 0.39855755803570936, &quot;z&quot;: 0.8973280277017416}, {&quot;x&quot;: 1.900541154142837, &quot;y&quot;: 0.34659603380864307, &quot;z&quot;: 0.8973280277017416}, {&quot;x&quot;: 1.960541154142837, &quot;y&quot;: 0.34659603380864307, &quot;z&quot;: 0.8973280277017416}, {&quot;x&quot;: 1.95652191625637, &quot;y&quot;: 0.44355755803570934, &quot;z&quot;: 0.9273280277017416}, {&quot;x&quot;: 1.9825026783699033, &quot;y&quot;: 0.39855755803570936, &quot;z&quot;: 0.9273280277017416}, {&quot;x&quot;: 1.904560392029304, &quot;y&quot;: 0.4435575580357094, &quot;z&quot;: 0.9273280277017416}, {&quot;x&quot;: 1.8785796299157707, &quot;y&quot;: 0.39855755803570936, &quot;z&quot;: 0.9273280277017416}, {&quot;x&quot;: 1.9045603920293037, &quot;y&quot;: 0.3535575580357094, &quot;z&quot;: 0.9273280277017416}, {&quot;x&quot;: 1.95652191625637, &quot;y&quot;: 0.3535575580357094, &quot;z&quot;: 0.9273280277017416}, {&quot;x&quot;: 1.945541154142837, &quot;y&quot;: 0.42453832014924253, &quot;z&quot;: 0.9492895519288079}, {&quot;x&quot;: 1.960541154142837, &quot;y&quot;: 0.39855755803570936, &quot;z&quot;: 0.9492895519288079}, {&quot;x&quot;: 1.915541154142837, &quot;y&quot;: 0.42453832014924253, &quot;z&quot;: 0.9492895519288079}, {&quot;x&quot;: 1.900541154142837, &quot;y&quot;: 0.39855755803570936, &quot;z&quot;: 0.9492895519288079}, {&quot;x&quot;: 1.915541154142837, &quot;y&quot;: 0.3725767959221762, &quot;z&quot;: 0.9492895519288079}, {&quot;x&quot;: 1.945541154142837, &quot;y&quot;: 0.3725767959221762, &quot;z&quot;: 0.9492895519288079}, {&quot;x&quot;: 1.930541154142837, &quot;y&quot;: 0.39855755803570936, &quot;z&quot;: 0.9573280277017415}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 6, 5], [0, 2, 6], [2, 1, 7, 8], [1, 3, 9, 7], [3, 4, 10, 9], [4, 5, 11, 10], [5, 6, 12, 11], [6, 2, 8, 12], [8, 7, 13, 14], [7, 9, 15, 13], [9, 10, 16, 15], [10, 11, 17, 16], [11, 12, 18, 17], [12, 8, 14, 18], [14, 13, 19, 20], [13, 15, 21, 19], [15, 16, 22, 21], [16, 17, 23, 22], [17, 18, 24, 23], [18, 14, 20, 24], [20, 19, 25, 26], [19, 21, 27, 25], [21, 22, 28, 27], [22, 23, 29, 28], [23, 24, 30, 29], [24, 20, 26, 30], [26, 25, 31], [25, 27, 31], [27, 28, 31], [28, 29, 31], [29, 30, 31], [30, 26, 31]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 1.8436740581349993, &quot;y&quot;: -0.3930497663635974, &quot;z&quot;: -0.9655550687444878}, {&quot;x&quot;: 1.8586740581349992, &quot;y&quot;: -0.3670690042500642, &quot;z&quot;: -0.9575165929715542}, {&quot;x&quot;: 1.8736740581349993, &quot;y&quot;: -0.3930497663635974, &quot;z&quot;: -0.9575165929715542}, {&quot;x&quot;: 1.8286740581349994, &quot;y&quot;: -0.3670690042500642, &quot;z&quot;: -0.9575165929715542}, {&quot;x&quot;: 1.8136740581349993, &quot;y&quot;: -0.3930497663635974, &quot;z&quot;: -0.9575165929715542}, {&quot;x&quot;: 1.8286740581349994, &quot;y&quot;: -0.4190305284771305, &quot;z&quot;: -0.9575165929715542}, {&quot;x&quot;: 1.8586740581349992, &quot;y&quot;: -0.41903052847713057, &quot;z&quot;: -0.9575165929715542}, {&quot;x&quot;: 1.8696548202485324, &quot;y&quot;: -0.3480497663635974, &quot;z&quot;: -0.9355550687444879}, {&quot;x&quot;: 1.8956355823620656, &quot;y&quot;: -0.3930497663635974, &quot;z&quot;: -0.9355550687444879}, {&quot;x&quot;: 1.8176932960214662, &quot;y&quot;: -0.3480497663635974, &quot;z&quot;: -0.9355550687444879}, {&quot;x&quot;: 1.791712533907933, &quot;y&quot;: -0.3930497663635974, &quot;z&quot;: -0.9355550687444879}, {&quot;x&quot;: 1.817693296021466, &quot;y&quot;: -0.4380497663635974, &quot;z&quot;: -0.9355550687444879}, {&quot;x&quot;: 1.8696548202485324, &quot;y&quot;: -0.4380497663635974, &quot;z&quot;: -0.9355550687444879}, {&quot;x&quot;: 1.8736740581349993, &quot;y&quot;: -0.3410882421365311, &quot;z&quot;: -0.9055550687444879}, {&quot;x&quot;: 1.9036740581349993, &quot;y&quot;: -0.3930497663635974, &quot;z&quot;: -0.9055550687444879}, {&quot;x&quot;: 1.8136740581349993, &quot;y&quot;: -0.34108824213653105, &quot;z&quot;: -0.9055550687444879}, {&quot;x&quot;: 1.7836740581349992, &quot;y&quot;: -0.3930497663635974, &quot;z&quot;: -0.9055550687444879}, {&quot;x&quot;: 1.8136740581349993, &quot;y&quot;: -0.4450112905906637, &quot;z&quot;: -0.9055550687444879}, {&quot;x&quot;: 1.8736740581349993, &quot;y&quot;: -0.4450112905906637, &quot;z&quot;: -0.9055550687444879}, {&quot;x&quot;: 1.8696548202485324, &quot;y&quot;: -0.3480497663635974, &quot;z&quot;: -0.8755550687444879}, {&quot;x&quot;: 1.8956355823620656, &quot;y&quot;: -0.3930497663635974, &quot;z&quot;: -0.8755550687444879}, {&quot;x&quot;: 1.8176932960214662, &quot;y&quot;: -0.3480497663635974, &quot;z&quot;: -0.8755550687444879}, {&quot;x&quot;: 1.791712533907933, &quot;y&quot;: -0.3930497663635974, &quot;z&quot;: -0.8755550687444879}, {&quot;x&quot;: 1.817693296021466, &quot;y&quot;: -0.4380497663635974, &quot;z&quot;: -0.8755550687444879}, {&quot;x&quot;: 1.8696548202485324, &quot;y&quot;: -0.4380497663635974, &quot;z&quot;: -0.8755550687444879}, {&quot;x&quot;: 1.8586740581349992, &quot;y&quot;: -0.3670690042500642, &quot;z&quot;: -0.8535935445174215}, {&quot;x&quot;: 1.8736740581349993, &quot;y&quot;: -0.3930497663635974, &quot;z&quot;: -0.8535935445174215}, {&quot;x&quot;: 1.8286740581349994, &quot;y&quot;: -0.3670690042500642, &quot;z&quot;: -0.8535935445174215}, {&quot;x&quot;: 1.8136740581349993, &quot;y&quot;: -0.3930497663635974, &quot;z&quot;: -0.8535935445174215}, {&quot;x&quot;: 1.8286740581349994, &quot;y&quot;: -0.4190305284771305, &quot;z&quot;: -0.8535935445174215}, {&quot;x&quot;: 1.8586740581349992, &quot;y&quot;: -0.41903052847713057, &quot;z&quot;: -0.8535935445174215}, {&quot;x&quot;: 1.8436740581349993, &quot;y&quot;: -0.3930497663635974, &quot;z&quot;: -0.8455550687444879}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 6, 5], [0, 2, 6], [2, 1, 7, 8], [1, 3, 9, 7], [3, 4, 10, 9], [4, 5, 11, 10], [5, 6, 12, 11], [6, 2, 8, 12], [8, 7, 13, 14], [7, 9, 15, 13], [9, 10, 16, 15], [10, 11, 17, 16], [11, 12, 18, 17], [12, 8, 14, 18], [14, 13, 19, 20], [13, 15, 21, 19], [15, 16, 22, 21], [16, 17, 23, 22], [17, 18, 24, 23], [18, 14, 20, 24], [20, 19, 25, 26], [19, 21, 27, 25], [21, 22, 28, 27], [22, 23, 29, 28], [23, 24, 30, 29], [24, 20, 26, 30], [26, 25, 31], [25, 27, 31], [27, 28, 31], [28, 29, 31], [29, 30, 31], [30, 26, 31]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 2.221768494959963, &quot;y&quot;: -0.6625118775718383, &quot;z&quot;: 0.6107905499061748}, {&quot;x&quot;: 2.2367684949599633, &quot;y&quot;: -0.6365311154583051, &quot;z&quot;: 0.6188290256791084}, {&quot;x&quot;: 2.251768494959963, &quot;y&quot;: -0.6625118775718383, &quot;z&quot;: 0.6188290256791084}, {&quot;x&quot;: 2.206768494959963, &quot;y&quot;: -0.6365311154583051, &quot;z&quot;: 0.6188290256791084}, {&quot;x&quot;: 2.1917684949599634, &quot;y&quot;: -0.6625118775718383, &quot;z&quot;: 0.6188290256791084}, {&quot;x&quot;: 2.206768494959963, &quot;y&quot;: -0.6884926396853714, &quot;z&quot;: 0.6188290256791084}, {&quot;x&quot;: 2.2367684949599633, &quot;y&quot;: -0.6884926396853714, &quot;z&quot;: 0.6188290256791084}, {&quot;x&quot;: 2.2477492570734965, &quot;y&quot;: -0.6175118775718382, &quot;z&quot;: 0.6407905499061747}, {&quot;x&quot;: 2.2737300191870293, &quot;y&quot;: -0.6625118775718383, &quot;z&quot;: 0.6407905499061747}, {&quot;x&quot;: 2.19578773284643, &quot;y&quot;: -0.6175118775718382, &quot;z&quot;: 0.6407905499061747}, {&quot;x&quot;: 2.169806970732897, &quot;y&quot;: -0.6625118775718383, &quot;z&quot;: 0.6407905499061747}, {&quot;x&quot;: 2.19578773284643, &quot;y&quot;: -0.7075118775718382, &quot;z&quot;: 0.6407905499061747}, {&quot;x&quot;: 2.2477492570734965, &quot;y&quot;: -0.7075118775718383, &quot;z&quot;: 0.6407905499061747}, {&quot;x&quot;: 2.251768494959963, &quot;y&quot;: -0.6105503533447719, &quot;z&quot;: 0.6707905499061747}, {&quot;x&quot;: 2.2817684949599633, &quot;y&quot;: -0.6625118775718383, &quot;z&quot;: 0.6707905499061747}, {&quot;x&quot;: 2.1917684949599634, &quot;y&quot;: -0.6105503533447719, &quot;z&quot;: 0.6707905499061747}, {&quot;x&quot;: 2.161768494959963, &quot;y&quot;: -0.6625118775718383, &quot;z&quot;: 0.6707905499061747}, {&quot;x&quot;: 2.1917684949599634, &quot;y&quot;: -0.7144734017989046, &quot;z&quot;: 0.6707905499061747}, {&quot;x&quot;: 2.251768494959963, &quot;y&quot;: -0.7144734017989046, &quot;z&quot;: 0.6707905499061747}, {&quot;x&quot;: 2.2477492570734965, &quot;y&quot;: -0.6175118775718382, &quot;z&quot;: 0.7007905499061747}, {&quot;x&quot;: 2.2737300191870293, &quot;y&quot;: -0.6625118775718383, &quot;z&quot;: 0.7007905499061747}, {&quot;x&quot;: 2.19578773284643, &quot;y&quot;: -0.6175118775718382, &quot;z&quot;: 0.7007905499061747}, {&quot;x&quot;: 2.169806970732897, &quot;y&quot;: -0.6625118775718383, &quot;z&quot;: 0.7007905499061747}, {&quot;x&quot;: 2.19578773284643, &quot;y&quot;: -0.7075118775718383, &quot;z&quot;: 0.7007905499061747}, {&quot;x&quot;: 2.2477492570734965, &quot;y&quot;: -0.7075118775718383, &quot;z&quot;: 0.7007905499061747}, {&quot;x&quot;: 2.2367684949599633, &quot;y&quot;: -0.6365311154583051, &quot;z&quot;: 0.722752074133241}, {&quot;x&quot;: 2.251768494959963, &quot;y&quot;: -0.6625118775718383, &quot;z&quot;: 0.722752074133241}, {&quot;x&quot;: 2.206768494959963, &quot;y&quot;: -0.6365311154583051, &quot;z&quot;: 0.722752074133241}, {&quot;x&quot;: 2.1917684949599634, &quot;y&quot;: -0.6625118775718383, &quot;z&quot;: 0.722752074133241}, {&quot;x&quot;: 2.206768494959963, &quot;y&quot;: -0.6884926396853714, &quot;z&quot;: 0.722752074133241}, {&quot;x&quot;: 2.2367684949599633, &quot;y&quot;: -0.6884926396853714, &quot;z&quot;: 0.722752074133241}, {&quot;x&quot;: 2.221768494959963, &quot;y&quot;: -0.6625118775718383, &quot;z&quot;: 0.7307905499061746}], &quot;faces&quot;: [[0, 1, 2], [0, 3, 1], [0, 4, 3], [0, 5, 4], [0, 6, 5], [0, 2, 6], [2, 1, 7, 8], [1, 3, 9, 7], [3, 4, 10, 9], [4, 5, 11, 10], [5, 6, 12, 11], [6, 2, 8, 12], [8, 7, 13, 14], [7, 9, 15, 13], [9, 10, 16, 15], [10, 11, 17, 16], [11, 12, 18, 17], [12, 8, 14, 18], [14, 13, 19, 20], [13, 15, 21, 19], [15, 16, 22, 21], [16, 17, 23, 22], [17, 18, 24, 23], [18, 14, 20, 24], [20, 19, 25, 26], [19, 21, 27, 25], [21, 22, 28, 27], [22, 23, 29, 28], [23, 24, 30, 29], [24, 20, 26, 30], [26, 25, 31], [25, 27, 31], [27, 28, 31], [28, 29, 31], [29, 30, 31], [30, 26, 31]], &quot;color&quot;: &quot;#ff0000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 1.0041808934613654, &quot;y&quot;: 0.335347390017691, &quot;z&quot;: 0.227293138427375}, {&quot;x&quot;: 1.0192114367840501, &quot;y&quot;: 0.3359311080871855, &quot;z&quot;: 0.2453632365217488}, {&quot;x&quot;: 1.318749889454176, &quot;y&quot;: -0.7452044768224885, &quot;z&quot;: 0.031133778941318715}, {&quot;x&quot;: 1.3037193461314915, &quot;y&quot;: -0.7457881948919831, &quot;z&quot;: 0.013063680846944925}, {&quot;x&quot;: 1.0076924274438972, &quot;y&quot;: 0.32892305182274006, &quot;z&quot;: 0.26462423275029}, {&quot;x&quot;: 1.3072308801140233, &quot;y&quot;: -0.752212533086934, &quot;z&quot;: 0.05039477516985995}, {&quot;x&quot;: 0.9855427448322707, &quot;y&quot;: 0.32400811678674646, &quot;z&quot;: 0.25845808498233824}, {&quot;x&quot;: 1.2850811975023968, &quot;y&quot;: -0.7571274681229275, &quot;z&quot;: 0.04422862740190818}, {&quot;x&quot;: 0.9833724974784158, &quot;y&quot;: 0.3279785761464503, &quot;z&quot;: 0.23538619985354853}, {&quot;x&quot;: 1.2829109501485418, &quot;y&quot;: -0.7531570087632237, &quot;z&quot;: 0.021156742273118454}], &quot;faces&quot;: [[0, 1, 2, 3], [1, 4, 5, 2], [4, 6, 7, 5], [6, 8, 9, 7], [8, 0, 3, 9]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 1.5448909990882824, &quot;y&quot;: 0.6594848233265556, &quot;z&quot;: -0.6655125401196691}, {&quot;x&quot;: 1.5485556940236727, &quot;y&quot;: 0.6369554157972737, &quot;z&quot;: -0.6711501115746574}, {&quot;x&quot;: 0.9880879306082839, &quot;y&quot;: 0.3190735291185471, &quot;z&quot;: 0.2348689496302518}, {&quot;x&quot;: 0.9844232356728936, &quot;y&quot;: 0.34160293664782904, &quot;z&quot;: 0.24050652108524015}, {&quot;x&quot;: 1.5686824639820671, &quot;y&quot;: 0.6301308351006742, &quot;z&quot;: -0.6610940370991222}, {&quot;x&quot;: 1.0082147005666784, &quot;y&quot;: 0.3122489484219477, &quot;z&quot;: 0.24492502410578715}, {&quot;x&quot;: 1.5774567969647149, &quot;y&quot;: 0.6484424198004914, &quot;z&quot;: -0.6492414698248526}, {&quot;x&quot;: 1.0169890335493261, &quot;y&quot;: 0.3305605331217649, &quot;z&quot;: 0.2567775913800566}, {&quot;x&quot;: 1.562752863018206, &quot;y&quot;: 0.6665841822294503, &quot;z&quot;: -0.6519722548709448}, {&quot;x&quot;: 1.0022850996028172, &quot;y&quot;: 0.34870229555072374, &quot;z&quot;: 0.2540468063339645}], &quot;faces&quot;: [[0, 1, 2, 3], [1, 4, 5, 2], [4, 6, 7, 5], [6, 8, 9, 7], [8, 0, 3, 9]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 1.9299182572921494, &quot;y&quot;: 0.4185119591098746, &quot;z&quot;: 0.8961305815506527}, {&quot;x&quot;: 1.941277274988349, &quot;y&quot;: 0.40413139697137374, &quot;z&quot;: 0.8814010685221041}, {&quot;x&quot;: 1.0107361208455115, &quot;y&quot;: 0.3360114875078269, &quot;z&quot;: 0.23029801932742247}, {&quot;x&quot;: 0.999377103149312, &quot;y&quot;: 0.3503920496463277, &quot;z&quot;: 0.2450275323559711}, {&quot;x&quot;: 1.9377993385833774, &quot;y&quot;: 0.3820479788716023, &quot;z&quot;: 0.8886820717423825}, {&quot;x&quot;: 1.0072581844405402, &quot;y&quot;: 0.3139280694080554, &quot;z&quot;: 0.2375790225477008}, {&quot;x&quot;: 1.9242908379781951, &quot;y&quot;: 0.3827802380366698, &quot;z&quot;: 0.9079114922332605}, {&quot;x&quot;: 0.9937496838353578, &quot;y&quot;: 0.31466032857312287, &quot;z&quot;: 0.2568084430385789}, {&quot;x&quot;: 1.9194200618721151, &quot;y&quot;: 0.40531621718902655, &quot;z&quot;: 0.9125149244603086}, {&quot;x&quot;: 0.9888789077292779, &quot;y&quot;: 0.33719630772547965, &quot;z&quot;: 0.2614118752656269}], &quot;faces&quot;: [[0, 1, 2, 3], [1, 4, 5, 2], [4, 6, 7, 5], [6, 8, 9, 7], [8, 0, 3, 9]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 2.4842832675693725, &quot;y&quot;: 0.7558071575641292, &quot;z&quot;: -0.04851070790325426}, {&quot;x&quot;: 2.4994474407678187, &quot;y&quot;: 0.7562058159297527, &quot;z&quot;: -0.03054754205713786}, {&quot;x&quot;: 2.7904177042663685, &quot;y&quot;: -0.31642935666140115, &quot;z&quot;: -0.2523741688672158}, {&quot;x&quot;: 2.7752535310679223, &quot;y&quot;: -0.31682801502702473, &quot;z&quot;: -0.2703373347133322}, {&quot;x&quot;: 2.488038450457871, &quot;y&quot;: 0.7491200083617746, &quot;z&quot;: -0.011249545380872666}, {&quot;x&quot;: 2.779008713956421, &quot;y&quot;: -0.32351516422937926, &quot;z&quot;: -0.23307617219095061}, {&quot;x&quot;: 2.465823133470559, &quot;y&quot;: 0.7443420800813993, &quot;z&quot;: -0.01728589336627462}, {&quot;x&quot;: 2.7567933969691087, &quot;y&quot;: -0.3282930925097546, &quot;z&quot;: -0.2391125201763526}, {&quot;x&quot;: 2.4635023028114946, &quot;y&quot;: 0.7484749655762961, &quot;z&quot;: -0.040314558265440226}, {&quot;x&quot;: 2.7544725663100444, &quot;y&quot;: -0.3241602070148577, &quot;z&quot;: -0.26214118507551815}], &quot;faces&quot;: [[0, 1, 2, 3], [1, 4, 5, 2], [4, 6, 7, 5], [6, 8, 9, 7], [8, 0, 3, 9]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 2.7705407990524096, &quot;y&quot;: -0.30189494297174807, &quot;z&quot;: -0.25266053679209177}, {&quot;x&quot;: 2.7819774425747035, &quot;y&quot;: -0.31629685811100133, &quot;z&quot;: -0.26730889607788744}, {&quot;x&quot;: 1.85446231819573, &quot;y&quot;: -0.38750145738611524, &quot;z&quot;: -0.9214556886177014}, {&quot;x&quot;: 1.8430256746734357, &quot;y&quot;: -0.373099542246862, &quot;z&quot;: -0.9068073293319058}, {&quot;x&quot;: 2.7785050773725413, &quot;y&quot;: -0.33836634767704876, &quot;z&quot;: -0.25998313914109394}, {&quot;x&quot;: 1.8509899529935674, &quot;y&quot;: -0.4095709469521627, &quot;z&quot;: -0.914129931680908}, {&quot;x&quot;: 2.764922394133958, &quot;y&quot;: -0.3376041272039739, &quot;z&quot;: -0.2408072130750396}, {&quot;x&quot;: 1.8374072697549844, &quot;y&quot;: -0.40880872647908784, &quot;z&quot;: -0.8949540056148536}, {&quot;x&quot;: 2.7600001994362526, &quot;y&quot;: -0.3150635594786453, &quot;z&quot;: -0.2362815959372565}, {&quot;x&quot;: 1.832485075057279, &quot;y&quot;: -0.3862681587537592, &quot;z&quot;: -0.8904283884770705}], &quot;faces&quot;: [[0, 1, 2, 3], [1, 4, 5, 2], [4, 6, 7, 5], [6, 8, 9, 7], [8, 0, 3, 9]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 2.7548973254147655, &quot;y&quot;: -0.31194688602877424, &quot;z&quot;: -0.2574580220110697}, {&quot;x&quot;: 2.7601866592701816, &quot;y&quot;: -0.33428090688268436, &quot;z&quot;: -0.26255712628173344}, {&quot;x&quot;: 2.2107659717161714, &quot;y&quot;: -0.6749476173660391, &quot;z&quot;: 0.659641699829115}, {&quot;x&quot;: 2.2054766378607558, &quot;y&quot;: -0.652613596512129, &quot;z&quot;: 0.6647408040997788}, {&quot;x&quot;: 2.780681106286506, &quot;y&quot;: -0.33942915801625856, &quot;z&quot;: -0.2522488986813777}, {&quot;x&quot;: 2.2312604187324965, &quot;y&quot;: -0.6800958684996133, &quot;z&quot;: 0.6699499274294708}, {&quot;x&quot;: 2.788058037267813, &quot;y&quot;: -0.3202769313455175, &quot;z&quot;: -0.2407789593899241}, {&quot;x&quot;: 2.2386373497138035, &quot;y&quot;: -0.6609436418288722, &quot;z&quot;: 0.6814198667209244}, {&quot;x&quot;: 2.772122784330598, &quot;y&quot;: -0.30329195316918306, &quot;z&quot;: -0.24399837465926388}, {&quot;x&quot;: 2.2227020967765885, &quot;y&quot;: -0.6439586636525377, &quot;z&quot;: 0.6782004514515846}], &quot;faces&quot;: [[0, 1, 2, 3], [1, 4, 5, 2], [4, 6, 7, 5], [6, 8, 9, 7], [8, 0, 3, 9]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 1.8269545817886828, &quot;y&quot;: -0.3840391044222118, &quot;z&quot;: -0.9118214139379022}, {&quot;x&quot;: 1.8333361204067917, &quot;y&quot;: -0.40616648562134877, &quot;z&quot;: -0.9165586463191245}, {&quot;x&quot;: 1.2892005149419186, &quot;y&quot;: -0.7638146555952625, &quot;z&quot;: 0.020991943351993343}, {&quot;x&quot;: 1.2828189763238094, &quot;y&quot;: -0.7416872743961256, &quot;z&quot;: 0.02572917573321578}, {&quot;x&quot;: 1.8540043375917037, &quot;y&quot;: -0.4101670066271639, &quot;z&quot;: -0.9060893084900452}, {&quot;x&quot;: 1.3098687321268303, &quot;y&quot;: -0.7678151766010777, &quot;z&quot;: 0.03146128118107269}, {&quot;x&quot;: 1.8603964596807345, &quot;y&quot;: -0.39051208338232857, &quot;z&quot;: -0.8948816694907468}, {&quot;x&quot;: 1.3162608542158614, &quot;y&quot;: -0.7481602533562424, &quot;z&quot;: 0.0426689201803712}, {&quot;x&quot;: 1.843678791207083, &quot;y&quot;: -0.37436415176493487, &quot;z&quot;: -0.8984243054846207}, {&quot;x&quot;: 1.2995431857422097, &quot;y&quot;: -0.7320123217388487, &quot;z&quot;: 0.03912628418649719}], &quot;faces&quot;: [[0, 1, 2, 3], [1, 4, 5, 2], [4, 6, 7, 5], [6, 8, 9, 7], [8, 0, 3, 9]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 2.2209491504785395, &quot;y&quot;: -0.6425902254430579, &quot;z&quot;: 0.6692232429545475}, {&quot;x&quot;: 2.2323872861922127, &quot;y&quot;: -0.6571349914161677, &quot;z&quot;: 0.6547178908842564}, {&quot;x&quot;: 1.3101572439023754, &quot;y&quot;: -0.7453210501818408, &quot;z&quot;: 0.015922861904711542}, {&quot;x&quot;: 1.2987191081887022, &quot;y&quot;: -0.730776284208731, &quot;z&quot;: 0.030428213975002703}, {&quot;x&quot;: 2.229150613342356, &quot;y&quot;: -0.6791104313027755, &quot;z&quot;: 0.6624244072926688}, {&quot;x&quot;: 1.3069205710525191, &quot;y&quot;: -0.7672964900684486, &quot;z&quot;: 0.02362937831312411}, {&quot;x&quot;: 2.2157121037970082, &quot;y&quot;: -0.6781472340973194, &quot;z&quot;: 0.6816926484382178}, {&quot;x&quot;: 1.2934820615071707, &quot;y&quot;: -0.7663332928629925, &quot;z&quot;: 0.042897619458673}, {&quot;x&quot;: 2.210643320989699, &quot;y&quot;: -0.6555765055998708, &quot;z&quot;: 0.6858945599611836}, {&quot;x&quot;: 1.2884132786998619, &quot;y&quot;: -0.7437625643655439, &quot;z&quot;: 0.04709953098163886}], &quot;faces&quot;: [[0, 1, 2, 3], [1, 4, 5, 2], [4, 6, 7, 5], [6, 8, 9, 7], [8, 0, 3, 9]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 2.4792568314831454, &quot;y&quot;: 0.7706828182909384, &quot;z&quot;: -0.03141205562031446}, {&quot;x&quot;: 2.4907299237723324, &quot;y&quot;: 0.7560222231033453, &quot;z&quot;: -0.04577247018847208}, {&quot;x&quot;: 1.5709787681722982, &quot;y&quot;: 0.6535517528515641, &quot;z&quot;: -0.6759849034917254}, {&quot;x&quot;: 1.559505675883111, &quot;y&quot;: 0.6682123480391573, &quot;z&quot;: -0.6616244889235677}, {&quot;x&quot;: 2.487677164743383, &quot;y&quot;: 0.7341308810281547, &quot;z&quot;: -0.0377577207252513}, {&quot;x&quot;: 1.5679260091433485, &quot;y&quot;: 0.6316604107763735, &quot;z&quot;: -0.6679701540285046}, {&quot;x&quot;: 2.4743173636148414, &quot;y&quot;: 0.7352618827539295, &quot;z&quot;: -0.018443918577508267}, {&quot;x&quot;: 1.554566208014807, &quot;y&quot;: 0.6327914125021483, &quot;z&quot;: -0.6486563518807615}, {&quot;x&quot;: 2.4691133114634134, &quot;y&quot;: 0.7578522223369836, &quot;z&quot;: -0.014522081861433112}, {&quot;x&quot;: 1.5493621558633792, &quot;y&quot;: 0.6553817520852024, &quot;z&quot;: -0.6447345151646864}], &quot;faces&quot;: [[0, 1, 2, 3], [1, 4, 5, 2], [4, 6, 7, 5], [6, 8, 9, 7], [8, 0, 3, 9]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 2.46370574587185, &quot;y&quot;: 0.7602083961243927, &quot;z&quot;: -0.03579526596041538}, {&quot;x&quot;: 2.469628758172803, &quot;y&quot;: 0.7379954873415389, &quot;z&quot;: -0.040723857360340454}, {&quot;x&quot;: 1.9199509933002166, &quot;y&quot;: 0.3857630398745778, &quot;z&quot;: 0.886185819735997}, {&quot;x&quot;: 1.9140279809992637, &quot;y&quot;: 0.4079759486574317, &quot;z&quot;: 0.891114411135922}, {&quot;x&quot;: 2.490187012811929, &quot;y&quot;: 0.733464167787691, &quot;z&quot;: -0.030254296061326347}, {&quot;x&quot;: 1.9405092479393427, &quot;y&quot;: 0.38123172032072994, &quot;z&quot;: 0.8966553810350111}, {&quot;x&quot;: 2.4969697006273313, &quot;y&quot;: 0.7528765670723798, &quot;z&quot;: -0.01885515993130993}, {&quot;x&quot;: 1.947291935754745, &quot;y&quot;: 0.40064411960541885, &quot;z&quot;: 0.9080545171650275}, {&quot;x&quot;: 2.4806033775932033, &quot;y&quot;: 0.7694054091873497, &quot;z&quot;: -0.022279667659587}, {&quot;x&quot;: 1.9309256127206171, &quot;y&quot;: 0.4171729617203886, &quot;z&quot;: 0.9046300094367504}], &quot;faces&quot;: [[0, 1, 2, 3], [1, 4, 5, 2], [4, 6, 7, 5], [6, 8, 9, 7], [8, 0, 3, 9]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 1.564407762990667, &quot;y&quot;: 0.653831881965742, &quot;z&quot;: -0.6786113736038764}, {&quot;x&quot;: 1.579687358511194, &quot;y&quot;: 0.6537701063349342, &quot;z&quot;: -0.6607419430309518}, {&quot;x&quot;: 1.8628936532308047, &quot;y&quot;: -0.3875991952795524, &quot;z&quot;: -0.9065029290775907}, {&quot;x&quot;: 1.8476140577102775, &quot;y&quot;: -0.3875374196487446, &quot;z&quot;: -0.9243723596505152}, {&quot;x&quot;: 1.5684061268593288, &quot;y&quot;: 0.6461758267240736, &quot;z&quot;: -0.641562601694267}, {&quot;x&quot;: 1.8516124215789393, &quot;y&quot;: -0.395193474890413, &quot;z&quot;: -0.8873235877409058}, {&quot;x&quot;: 1.5461543467429881, &quot;y&quot;: 0.6415440794352993, &quot;z&quot;: -0.6475785474392846}, {&quot;x&quot;: 1.8293606414625987, &quot;y&quot;: -0.39982522217918737, &quot;z&quot;: -0.8933395334859234}, {&quot;x&quot;: 1.5436832219727656, &quot;y&quot;: 0.6462757817943972, &quot;z&quot;: -0.6704759477208655}, {&quot;x&quot;: 1.8268895166923762, &quot;y&quot;: -0.39509351982008956, &quot;z&quot;: -0.9162369337675044}], &quot;faces&quot;: [[0, 1, 2, 3], [1, 4, 5, 2], [4, 6, 7, 5], [6, 8, 9, 7], [8, 0, 3, 9]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}, {&quot;vertices&quot;: [{&quot;x&quot;: 1.9346165168119598, &quot;y&quot;: 0.4037092173713709, &quot;z&quot;: 0.878437505601905}, {&quot;x&quot;: 1.9497578384831822, &quot;y&quot;: 0.40402540854239455, &quot;z&quot;: 0.8964215764895539}, {&quot;x&quot;: 2.2409851793003086, &quot;y&quot;: -0.6570440270651534, &quot;z&quot;: 0.6698840986939869}, {&quot;x&quot;: 2.225843857629086, &quot;y&quot;: -0.6573602182361771, &quot;z&quot;: 0.6519000278063382}, {&quot;x&quot;: 1.9383423555471255, &quot;y&quot;: 0.39678521615858287, &quot;z&quot;: 0.9156583321433026}, {&quot;x&quot;: 2.2295696963642517, &quot;y&quot;: -0.6642842194489649, &quot;z&quot;: 0.6891208543477357}, {&quot;x&quot;: 1.9161458774234255, &quot;y&quot;: 0.3919943400092757, &quot;z&quot;: 0.9095632300829473}, {&quot;x&quot;: 2.2073732182405514, &quot;y&quot;: -0.6690750955982723, &quot;z&quot;: 0.6830257522873804}, {&quot;x&quot;: 1.9138431824484923, &quot;y&quot;: 0.3962736080969239, &quot;z&quot;: 0.8865594941909993}, {&quot;x&quot;: 2.2050705232656185, &quot;y&quot;: -0.6647958275106238, &quot;z&quot;: 0.6600220163954325}], &quot;faces&quot;: [[0, 1, 2, 3], [1, 4, 5, 2], [4, 6, 7, 5], [6, 8, 9, 7], [8, 0, 3, 9]], &quot;color&quot;: &quot;#000000&quot;, &quot;opacity&quot;: 1.0}];
    for ( var i=0 ; i < surfaces.length ; i++ ) addSurface( surfaces[i] );

    function addSurface( json ) {

        var useFaceColors = 'faceColors' in json ? true : false;

        var geometry = new THREE.Geometry();
        for ( var i=0 ; i < json.vertices.length ; i++ ) {
            var v = json.vertices[i];
            geometry.vertices.push( new THREE.Vector3( a[0]*v.x, a[1]*v.y, a[2]*v.z ) );
        }
        for ( var i=0 ; i < json.faces.length ; i++ ) {
            var f = json.faces[i];
            for ( var j=0 ; j < f.length - 2 ; j++ ) {
                var face = new THREE.Face3( f[0], f[j+1], f[j+2] );
                if ( useFaceColors ) face.color.set( json.faceColors[i] );
                geometry.faces.push( face );
            }
        }
        geometry.computeVertexNormals();

        var side = json.singleSide ? THREE.FrontSide : THREE.DoubleSide;
        var transparent = json.opacity < 1 ? true : false;
        var depthWrite = 'depthWrite' in json ? json.depthWrite : !transparent;
        var flatShading = json.useFlatShading ? json.useFlatShading : false;

        var material = new THREE.MeshPhongMaterial( { side: side,
                                     color: useFaceColors ? 'white' : json.color,
                                     vertexColors: useFaceColors ? THREE.FaceColors : THREE.NoColors,
                                     transparent: transparent, opacity: json.opacity,
                                     shininess: 20, flatShading: flatShading,
                                     depthWrite: depthWrite } );

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var mesh = new THREE.Mesh( geometry, material );
        mesh.position.set( c.x, c.y, c.z );
        if ( transparent &amp;&amp; json.renderOrder ) mesh.renderOrder = json.renderOrder;
        mesh.userData = json;
        scene.add( mesh );

        if ( json.showMeshGrid ) addSurfaceMeshGrid( json );

    }

    function addSurfaceMeshGrid( json ) {

        var geometry = new THREE.Geometry();

        for ( var i=0 ; i < json.faces.length ; i++ ) {
            var f = json.faces[i];
            for ( var j=0 ; j < f.length ; j++ ) {
                var k = j === f.length-1 ? 0 : j+1;
                var v1 = json.vertices[f[j]];
                var v2 = json.vertices[f[k]];
                // vertices in opposite directions on neighboring faces
                var nudge = f[j] < f[k] ? .0005*zRange : -.0005*zRange;
                geometry.vertices.push( new THREE.Vector3( a[0]*v1.x, a[1]*v1.y, a[2]*(v1.z+nudge) ) );
                geometry.vertices.push( new THREE.Vector3( a[0]*v2.x, a[1]*v2.y, a[2]*(v2.z+nudge) ) );
            }
        }

        var c = new THREE.Vector3();
        geometry.computeBoundingBox();
        geometry.boundingBox.getCenter( c );
        geometry.translate( -c.x, -c.y, -c.z );

        var gridColor = options.theme === 'dark' ? 'white' : 'black';
        var linewidth = json.linewidth || 1;
        var materialOptions = { color: gridColor, linewidth: linewidth };

        var mesh;
        if ( linewidth > 1 &amp;&amp; window.createFatLineSegments ) {
            mesh = createFatLineSegments( geometry, materialOptions );
        } else {
            var material = new THREE.LineBasicMaterial( materialOptions );
            mesh = new THREE.LineSegments( geometry, material );
        }

        mesh.position.set( c.x, c.y, c.z );
        mesh.userData = json;
        scene.add( mesh );

    }

    function render() {

        if ( window.updateAnimation ) animate = updateAnimation();
        if ( animate ) requestAnimationFrame( render );

        renderer.render( scene, camera );

    }

    render();
    controls.update();
    if ( !animate ) render();


    // menu functions

    function toggleMenu() {

        var m = document.getElementById( 'menu-content' );
        if ( m.style.display === 'block' ) m.style.display = 'none'
        else m.style.display = 'block';

    }


    function saveAsPNG() {

        var a = document.body.appendChild( document.createElement( 'a' ) );
        a.href = renderer.domElement.toDataURL( 'image/png' );
        a.download = 'screenshot';
        a.click();

    }

    function saveAsHTML() {

        toggleMenu(); // otherwise visible in output
        event.stopPropagation();

        var blob = new Blob( [ '<!DOCTYPE html>\n' + document.documentElement.outerHTML ] );
        var a = document.body.appendChild( document.createElement( 'a' ) );
        a.href = window.URL.createObjectURL( blob );
        a.download = suggestFilename();
        a.click();

        function suggestFilename() {
            if ( !document.title ) {
                return 'graphic.html';
            } else if ( /\.html?$/i.test( document.title ) ) {
                return document.title; // already ends in .htm or .html
            } else {
                return document.title + '.html';
            }
        }

    }

    function getViewpoint() {

        function roundTo( x, n ) { return +x.toFixed(n); }

        var v = camera.quaternion.inverse();
        var r = Math.sqrt( v.x*v.x + v.y*v.y + v.z*v.z );
        var axis = [ roundTo( v.x / r, 4 ), roundTo( v.y / r, 4 ), roundTo( v.z / r, 4 ) ];
        var angle = roundTo( 2 * Math.atan2( r, v.w ) * 180 / Math.PI, 2 );

        var textArea = document.createElement( 'textarea' );
        textArea.textContent = JSON.stringify( axis ) + ',' + angle;
        textArea.style.csstext = 'position: absolute; top: -100%';
        document.body.append( textArea );
        textArea.select();
        document.execCommand( 'copy' );

        var m = document.getElementById( 'menu-message' );
        m.innerHTML = 'Viewpoint copied to clipboard';
        m.style.display = 'block';
        setTimeout( function() { m.style.display = 'none'; }, 2000 );

    }

    function getCamera() {

        function roundTo( x, n ) { return +x.toFixed(n); }

        var pos = camera.position;
        var pos_r = [ roundTo( pos.x, 4 ), roundTo( pos.y, 4 ), roundTo( pos.z, 4 ) ];
   //     var up = camera.up; // up is always (0,0,1)
        var textArea = document.createElement('textarea');
        var cam_position = JSON.stringify(pos_r);
        textArea.textContent = ',camera_position=' + cam_position;
        textArea.style.csstext = 'position: absolute; top: -100%';
        document.body.append( textArea );
        textArea.select();
        document.execCommand( 'copy' );

        var m = document.getElementById( 'menu-message' );
        m.innerHTML = 'Camera position '+ cam_position+' copied to clipboard';
        m.style.display = 'block';
        setTimeout( function() { m.style.display = 'none'; }, 2000 );

    }

</script>

<div id=&quot;menu-container&quot; onclick=&quot;toggleMenu()&quot;>ⓘ
<div id=&quot;menu-message&quot;></div>
<div id=&quot;menu-content&quot;>
<div onclick=&quot;saveAsPNG()&quot;>Save as PNG</div>
<div onclick=&quot;saveAsHTML()&quot;>Save as HTML</div>
<div onclick=&quot;getCamera()&quot;>Get camera</div>
<div onclick=&quot;getViewpoint()&quot;>Get viewpoint</div>
<div>Close Menu</div>
</div></div>


</body>
</html>
" width="100%" height="400" style="border: 0;">
</iframe>
</div>
</div>
<p><strong>Exercise</strong>: Edit the code above and plot <span class="math inline">\(Q_n\)</span> for small values of <span class="math inline">\(n\)</span>. Using relevant function, make a conjecture for the number of vertices and the number of edges (harder) of <span class="math inline">\(Q_n\)</span> for arbitrary <span class="math inline">\(n\)</span>.</p>
<p><strong>Exercise</strong>: Change the layout to “circular” and guess what this layout does in general.</p>
<div class="cell" data-execution_count="116">
<pre class="sage cell-code"><code>qn_list = []
for i in range(2,6):
    qn_list .append(graphs.CubeGraph(i))
    
graphs_list.show_graphs(qn_list)</code></pre>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Let’s also plot <span class="math inline">\(Q_8\)</span> on its own.</p>
<div class="cell" data-scrolled="true" data-execution_count="125">
<pre class="sage cell-code"><code>Q8 = graphs.CubeGraph(8)
Q8P = C.graphplot(vertex_labels=False, vertex_size=0,graph_border=True)
Q8P.show()</code></pre>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-16-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="chromatic-number" class="level3">
<h3 class="anchored" data-anchor-id="chromatic-number">Chromatic Number</h3>
<p>The chromatic number of a graph <span class="math inline">\(G\)</span> is the smallest amount of colors to color the vertices of <span class="math inline">\(G\)</span> so that adjacent vertices of <span class="math inline">\(G\)</span> have different colors.</p>
<p>We can access <span class="math inline">\(Q_4\)</span> from the list we created above.</p>
<div class="cell" data-execution_count="117">
<pre class="sage cell-code"><code>Q4 = qn_list[2]</code></pre>
</div>
<p>We first construct a coloring and save it in a dictionary with RGB Hex labeling.</p>
<div class="cell" data-execution_count="137">
<pre class="sage cell-code"><code>Q4_colors = Q4.coloring(hex_colors=True)</code></pre>
</div>
<p>Then, we simply set the vertex_colors to our dictionary.</p>
<div class="cell" data-execution_count="123">
<pre class="sage cell-code"><code>Q4.plot(vertex_colors=Q4_colors, vertex_labels=False)</code></pre>
<div class="cell-output cell-output-display" data-execution_count="123">
<p><img src="index_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Now, let’s do the same for <span class="math inline">\(Q_8\)</span> for a more interesting plot.</p>
<div class="cell" data-execution_count="126">
<pre class="sage cell-code"><code>Q8_colors = Q8.coloring(hex_colors=True)</code></pre>
</div>
<div class="cell" data-execution_count="131">
<pre class="sage cell-code"><code>Q8.plot(vertex_colors=Q8_colors, vertex_labels=False, vertex_size = 30)</code></pre>
<div class="cell-output cell-output-display" data-execution_count="131">
<p><img src="index_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><strong>Exercise</strong>: Find the chromatic numbers of <span class="math inline">\(K_n, P_n,\)</span> and <span class="math inline">\(C_n\)</span> in terms of <span class="math inline">\(n\)</span>.</p>
<p><strong>Exercise</strong>: Show that the chromatic number of <span class="math inline">\(Q_n\)</span> is <span class="math inline">\(2\)</span> for all <span class="math inline">\(n\)</span>. (Hint: Consider the sums of the digits of the vertices)</p>
<p>If you are into puzzles, the next exercise might come as a nice suprise.</p>
<p><strong>Exercise</strong>: Think about how you would solve a standard Sudoku puzzle using graph theory and Sage.</p>
<p>Let’s end by noting that graph colorings can be used to solve many scheduling and timetabling problems. There is a comprehensive <a href="https://link.springer.com/book/10.1007/978-3-030-81054-2">textbook</a> called <em>Guide to Graph Colouring</em> by R. Lewis on applications of graph colourings and the author also has a <a href="https://youtu.be/y4RAYQjKb5Y?si=RzJ8nbOgwFATkH-d">short video</a> on some of these applications.</p>
<p>Click here for <a href="https://youtu.be/y4RAYQjKb5Y?si=RzJ8nbOgwFATkH-d">Part 2</a> of this tutorial.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>